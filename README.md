# Practical-Malware-Analysis
Write up for PMA labs solution
## CHAPTER 1
### Lab 1-1
#### Questions
1. Upload the files to http://www.VirusTotal.com/ and view the reports. Does
either file match any existing antivirus signatures?
2. When were these files compiled?
3. Are there any indications that either of these files is packed or obfuscated?
If so, what are these indicators?
4. Do any imports hint at what this malware does? If so, which imports
are they?
5. Are there any other files or host-based indicators that you could look for
on infected systems?
6. What network-based indicators could be used to find this malware on
infected machines?
7. What would you guess is the purpose of these files?
#### Solution
1- These files were written specifically for this book, so as of this writing,
you should not find a signature for them on VirusTotal.com. Of course, if
these files become part of the antivirus signatures as a result of the publi-
cation of this book, the results will be different.

2-Both files were compiled on December 19, 2010, within 1 minute of each other.
![dll](https://github.com/A8N0RMAL/Practical-Malware-Analysis/assets/119806250/0640abd7-1014-4143-bcbd-8c1807e03a88)
![exe01](https://github.com/A8N0RMAL/Practical-Malware-Analysis/assets/119806250/e83893ce-ef66-41fc-bc9f-3f7e8afb34e1)

3- There are no indications that either file is packed or obfuscated, PEiD labels this as unpacked code compiled with Microsoft Visual C++,
which tells us that these files are not packed.
![Unpackeddll](https://github.com/A8N0RMAL/Practical-Malware-Analysis/assets/119806250/c30663f6-43f0-4fb2-96bc-696456578b0d)
![Unpackedexe01](https://github.com/A8N0RMAL/Practical-Malware-Analysis/assets/119806250/2362d06b-7645-4fe6-8f77-d2f9001cfebe)

4- The interesting imports from Lab01-01.exe are FindFirstFile, FindNextFile,
and CopyFile. These imports tell us that the program searches the file-
system and copies files. The most interesting imports from Lab01-01.dll
are CreateProcess and Sleep. We also see that this file imports functions
from WS2_32.dll, which provides network functionality.
![exe01](https://github.com/A8N0RMAL/Practical-Malware-Analysis/assets/119806250/ed8bfaac-8c8c-458c-a3c0-bcdc30a1ed7a)

5- Examine C:\Windows\System32\kerne132.dll for additional malicious activ-
ity. Note that the file kerne132.dll, with the number 1 instead of the letter
l, is meant to look like the system file kernel32.dll. This file can be used as
a host indicator to search for the malware.

6- The .dll file contains a reference to local IP address 127.26.152.13. This
address is an artifact of this program having been created for educational
and not malicious purposes. If this was real malware(and that is :') ), the IP address should
be routable, and it would be a good network-based indicator for use in
identifying this malware.

7- The .dll file is probably a backdoor because it imports functions
from WS2_32.dll, which provides network functionality and we also see two interest-
ing functions imported from kernel32.dll: CreateProcess and Sleep, which are
commonly used as backdoors. These functions are particularly interesting to
us in combination with the strings exec and sleep. The exec string is probably
sent over the network to command the backdoor to run a program with
CreateProcess. The sleep string is probably used to command the backdoor
program to sleep. The .exe file is used to install or run the DLL.
[!NOTE]
>Hackers use backdoors to communicate with a command-and-control server and bypass security
[!NOTE]
Backdoor -> Malicious code that installs itself onto a computer to allow
the attacker access. Backdoors usually let the attacker connect to the
computer with little or no authentication and execute commands on the
local system
![how_a_backdoor_attack_works-f](https://github.com/A8N0RMAL/Practical-Malware-Analysis/assets/119806250/8ece181f-8d26-452b-bb76-99be989936c0)



